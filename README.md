# Система Email-рассылок

## Обзор

Система Email-рассылок — это приложение на Django для управления и отправки email-кампаний. Это приложение позволяет создавать и управлять списками рассылок, составлять сообщения и планировать отправку писем с различными интервалами.

## Возможности

- **Управление клиентами**: Хранение и управление данными клиентов.
- **Создание сообщений**: Составление и хранение email-сообщений.
- **Списки рассылок**: Создание и управление email-кампаниями, настройка интервалов отправки.
- **Автоматическая отправка**: Автоматическая отправка писем на основе расписания.
- **Ручной запуск**: Ручной запуск рассылок через командную строку.
- **Логирование и мониторинг**: Отслеживание попыток отправки и их статусов.

## Содержание

- [Установка](#установка)
- [Использование](#использование)
- [Запуск периодических задач](#запуск-периодических-задач)
- [Командная строка](#командная-строка)


## Установка

1. **Клонируйте репозиторий**:

    ```bash
    git clone https://github.com/вашпользователь/email-mailing-system.git
    cd email-mailing-system
    ```

2. **Создайте виртуальное окружение**:

    ```bash
    python -m venv env
    source env/bin/activate   # На Windows используйте `env\Scripts\activate`
    ```

3. **Установите зависимости**:

    ```bash
    pip install -r requirements.txt
    ```

4. **Создайте файл переменных окружения**:

   В корневой директории проекта скопируйте файл `.env.sample` в `.env` и заполните переменные окружения:

5. **Примените миграции**:

    ```bash
    python manage.py migrate
    ```

6. **Создайте суперпользователя (по желанию)**:

    ```bash
    python manage.py csu
    ```


## Использование

1. **Запуск сервера разработки**:

    ```bash
    python manage.py runserver
    ```

2. **Доступ к админ-панели**:

   Перейдите по адресу [http://127.0.0.1:8000/admin](http://127.0.0.1:8000/admin) и войдите с учетными данными суперпользователя.

3. **Создание и управление рассылками**:

   - Добавьте клиентов через админ-панель или создайте их через оболочку Django.
   - Составьте сообщения и создайте списки рассылок.
   - Запланируйте рассылки и проверьте статус email-кампаний.

## Запуск периодических задач

Система использует `django-apscheduler` для обработки периодических задач.

1. **Запуск планировщика задач**:

   Убедитесь, что планировщик задач запускается вместе с вашим приложением Django. Он настроен в `apps.py` вашего приложения:

    ```python
    from django.apps import AppConfig

    class MainConfig(AppConfig):
        name = 'main'

        def ready(self):
            from main.scheduler import start
            start()
    ```

2. **Настройка планировщика**:

   Вы можете настроить интервал выполнения задач в `scheduler.py`:

    ```python
    from apscheduler.schedulers.background import BackgroundScheduler
    from main.tasks import send_mailing

    def start():
        scheduler = BackgroundScheduler(timezone=settings.TIME_ZONE)
        scheduler.add_job(send_mailing, 'interval', minutes=60)
        scheduler.start()
    ```

## Командная строка

Для ручного запуска рассылок:

```bash
python manage.py send_mailing
